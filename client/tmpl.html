<div>
    <tmpl id="message" class="br-tmpl">
        <div>##=data.msg##</div>
    </tmpl>
    
    <tmpl id="login" class="br-tmpl">
        ##if(!data.name) {##
        <input type="text" name="login_id" value=""/>
        <input type="password" name="password" value=""/>
        <input type="submit" value="Sign In" data-event="##:model.login##"/>
        ##} else {##
        <span>##=data.name##</span>
        <input type="submit" value="Sign Out" data-event="##:model.logout##"/>
        ##}##
    </tmpl>

    <tmpl id="edit" class="br-tmpl">
        <input type="date" name="serviceDate" value="##=data.serviceDate##"/>
        <input type="time" step="1800" list="timeList" name="serviceTime" value="##=data.serviceTime##"/>
        <datalist id="timeList">
            <option value="01:00">
            <option value="02:00">
            <option value="03:00">
            <option value="04:00">
            <option value="05:00">
            <option value="06:00">
            <option value="07:00">
            <option value="08:00">
            <option value="09:00">
            <option value="10:00">
        </datalist>
        本：<input type="number" name="calcBooks" value="##=data.calcBooks##"/>
        雑誌：<input type="number" name="calcMagazines" value="##=data.calcMagazines##"/>
        
        <!--<input type="submit" value="修正" data-event="##:model.update##"/>-->
        <input type="submit" value="新規追加" data-event="##:model.insert##"/>
    </tmpl>

    <script type="text/tmpl" id="serviceTable" class="br-tmpl">
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>日付</th>
                    <th>奉仕時間</th>
                    <th>本</th>
                    <th>雑誌</th>
                    <th></th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
				##totalData={};##
                ##$.each(data || {} , function(ind, obj) {##
                <tr>
					##
					//totalData.totalServiceTime = totalData.totalServiceTime ? totalData.totalServiceTime + new Date(obj.serviceTime) : new Date(obj.serviceTime);
					totalData.totalCalcBooks = totalData.totalCalcBooks ? totalData.totalCalcBooks + new Number(obj.calcBooks) : new Number(obj.calcBooks);
					totalData.totalCalcMagazines = totalData.totalCalcMagazines ? totalData.totalCalcMagazines + new Number(obj.calcMagazines) : new Number(obj.calcMagazines);
					##
                    <td>##=obj.serviceDate##</td>
                    <td>##=obj.serviceTime##</td>
                    <td>##=obj.calcBooks##</td>
                    <td>##=obj.calcMagazines##</td>
                    <td><a href="#edit/##=obj._id##" data-ind="##=ind##" data-id="##=obj._id##" data-event="##:model.oneline##">修正</a></td>
                    <td><a href="#delete/##=obj._id##" data-event="##:model.lineDelete##">削除</a></td>
                </tr>
                ##});##
            </tbody>
            <tfoot>
                <tr>
                    <td></td>
                    <td id="totalServiceTime">##=totalData.totalServiceTime##</td>
                    <td id="totalCalcBooks">##=totalData.totalCalcBooks##</td>
                    <td id="totalCalcMagazines">##=totalData.totalCalcMagazines##</td>
                    <td></td>
                    <td></td>
                </tr>
            </tfoot>
        </table>
    </script>
</div>