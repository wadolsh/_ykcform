<!DOCTYPE html>
<html lang="ja">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<title>記録</title>
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/app.css" rel="stylesheet">
</head>
<body>

    <nav class="navbar navbar-default navbar-fixed-top" role="navigation" data-bind-tmpl-id="header" data-tmpl-src="./tmpl/tmpl.common.html">
        <div id="navMenu">
            <script type="text/tmpl" data-tmpl-id="navMenu" data-tmpl-option='{"render": true}'>
                <button type="button" id="mapToggleButton" class="btn btn-default btn-xs" aria-label="Left Align" data-event="##:findServiceModel.showSearchedMap##">
                    <span class="glyphicon glyphicon-map-marker" aria-hidden="true">地図</span>
                </button>
            </script>
        </div>
    </nav>
    
    <div class="container hidden" id="searchedMapArea" style="height: 100%; position: absolute; height:calc(100% - 52px); width: 100%; margin-top: -18px;">
        <div id="searchedMap" style="height: 100%;">
            
        </div>
        <div class="modal" id="searchedMapModal">
          <script type="text/tmpl" data-tmpl-id="searchedMapModal">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">##=data.findServiceAddress2 + data.findServiceAddress3 + data.findServiceAddress4 + ' ' + data.findServiceAddress5+ ' ' + data.findServiceName##</h4>
              </div>
              <div class="modal-body br-form">
                <input type="hidden" name="##=Bridge.idName##" value="##=data[Bridge.idName]##">
                <div class="row">
        			<div class="form-group col-sm-12">
        				<label for="findServiceComment" class="">コメント</label>
        				<textarea class="form-control" rows="5" id="searchedMapModalComment" name="findServiceComment" data-event="##:{keydown: function(e){
        				    $('#searchedMapModalSubmitButton').removeClass('disabled');
        				}}##">##=data.findServiceComment##</textarea>
        			</div>
                </div>
                <div class="row">
        			<div class="form-group col-sm-12">
        			    <button type="submit" id="searchedMapModalSubmitButton" class="btn btn-primary disabled" data-event="##:findServiceModel.saveComment::data##">コメント登録</button>
        			</div>
                </div>
              </div>
              <div class="modal-footer">
              	##$.each(findServiceModel.resultTypeModel, function(key, obj) {##
              	    <button type="button" class="btn ##=(data.result==key) ? obj.color : 'btn-default'##" data-event="##:findServiceModel.setResult::data##" data-resultType="##=key##" data-fromMap="true">##=obj.label##</button>
                ##});##
              </div>
            </div><!-- /.modal-content -->
          </div><!-- /.modal-dialog -->
          </script>
        </div><!-- /.modal -->
        
    </div>
    
<datalist id="findServiceMapKuList">
    <option value=""></option>
    <option value="横浜市鶴見区">横浜市鶴見区</option>
    <option value="横浜市神奈川区">横浜市神奈川区</option>
    <option value="横浜市西区">横浜市西区</option>
    <option value="横浜市中区">横浜市中区</option>
    <option value="横浜市南区">横浜市南区</option>
    <option value="横浜市保土ヶ谷区">横浜市保土ヶ谷区</option>
    <option value="横浜市磯子区">横浜市磯子区</option>
    <option value="横浜市金沢区">横浜市金沢区</option>
    <option value="横浜市港北区">横浜市港北区</option>
    <option value="横浜市戸塚区">横浜市戸塚区</option>
    <option value="横浜市港南区">横浜市港南区</option>
    <option value="横浜市旭区">横浜市旭区</option>
    <option value="横浜市緑区">横浜市緑区</option>
    <option value="横浜市瀬谷区">横浜市瀬谷区</option>
    <option value="横浜市栄区">横浜市栄区</option>
    <option value="横浜市泉区">横浜市泉区</option>
    <option value="横浜市青葉区">横浜市青葉区</option>
    <option value="横浜市都筑区">横浜市都筑区</option>
    <option value="川崎市川崎区">川崎市川崎区</option>
    <option value="川崎市幸区">川崎市幸区</option>
    <option value="川崎市中原区">川崎市中原区</option>
    <option value="川崎市高津区">川崎市高津区</option>
    <option value="川崎市多摩区">川崎市多摩区</option>
    <option value="川崎市宮前区">川崎市宮前区</option>
    <option value="川崎市麻生区">川崎市麻生区</option>
    <option value="相模原市緑区">相模原市緑区</option>
    <option value="相模原市中央区">相模原市中央区</option>
    <option value="相模原市南区">相模原市南区</option>
    <option value="横須賀市">横須賀市</option>
    <option value="平塚市">平塚市</option>
    <option value="鎌倉市">鎌倉市</option>
    <option value="藤沢市">藤沢市</option>
    <option value="小田原市">小田原市</option>
    <option value="茅ヶ崎市">茅ヶ崎市</option>
    <option value="逗子市">逗子市</option>
    <option value="三浦市">三浦市</option>
    <option value="秦野市">秦野市</option>
    <option value="厚木市">厚木市</option>
    <option value="大和市">大和市</option>
    <option value="伊勢原市">伊勢原市</option>
    <option value="海老名市">海老名市</option>
    <option value="座間市">座間市</option>
    <option value="南足柄市">南足柄市</option>
    <option value="綾瀬市">綾瀬市</option>
    <option value="三浦郡葉山町">三浦郡葉山町</option>
    <option value="高座郡寒川町">高座郡寒川町</option>
    <option value="中郡大磯町">中郡大磯町</option>
    <option value="中郡二宮町">中郡二宮町</option>
    <option value="足柄上郡中井町">足柄上郡中井町</option>
    <option value="足柄上郡大井町">足柄上郡大井町</option>
    <option value="足柄上郡松田町">足柄上郡松田町</option>
    <option value="足柄上郡山北町">足柄上郡山北町</option>
    <option value="足柄上郡開成町">足柄上郡開成町</option>
    <option value="足柄下郡箱根町">足柄下郡箱根町</option>
    <option value="足柄下郡真鶴町">足柄下郡真鶴町</option>
    <option value="足柄下郡湯河原町">足柄下郡湯河原町</option>
    <option value="愛甲郡愛川町">愛甲郡愛川町</option>
    <option value="愛甲郡清川村">愛甲郡清川村</option>
</datalist>
<datalist id="findServiceFindFromList">
    <option value=""></option>
    <option value="電話帳">
    <option value="ゼンリン">
    <option value="その他">
</datalist>
<datalist id="townNameList" class="br-tmpl">
    <script type="text/tmpl" data-tmpl-id="townNameList">
        <option value=""></option>
    ##for(var ind in data.town) {##
        <option value="##=data.town[ind]##">
    ##}##
    </script>
</datalist>

    <div class="container" id="findService">
    	<div id="findServiceTable" class="panel panel-default br-tmpl">
		    <script type="text/tmpl" data-tmpl-id="findServiceTable">
        		<div class="panel-heading">
        		    探し記録
        		    
        		    <a href="http://ko.wikipedia.org/wiki/%EB%8C%80%ED%95%9C%EB%AF%BC%EA%B5%AD%EC%9D%98_%EC%9D%B8%EA%B5%AC%EC%88%9C_%EC%84%B1%EC%94%A8_%EB%AA%A9%EB%A1%9D" class="btn btn-default btn-sm" target="wiki1">韓国姓1</a>
        		    <a href="http://ko.wikipedia.org/wiki/%ED%95%9C%EA%B5%AD%EC%9D%98_%EC%84%B1%EC%94%A8_%EB%AA%A9%EB%A1%9D" class="btn btn-default btn-sm" target="wiki2">韓国姓2</a>
        		    
                    <button type="button" class="btn btn-default btn-sm pull-right ##=data.editMode=='new' || data.editMode=='no' ? 'hidden': ''##" data-event="##:findServiceModel.addNew##">
                        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> 新規追加
                    </button>
                    <button type="button" class="btn btn-default btn-sm pull-right ##=(!data.editMode) ? 'hidden': ''##" data-event="##:findServiceModel.listArea##">
                        <span class="glyphicon glyphicon-list-alt" aria-hidden="true"></span> 一覧
                    </button>
                    <!--
                    <button type="button" class="btn btn-default btn-sm pull-right ##=(data.editMode) ? 'hidden': ''##" data-event="##:{
                                                        click:function(){
                                                            $('#matchData').toggleClass('hidden');
                                                        }}##">
                        <span class="glyphicon glyphicon-search" aria-hidden="true"></span> 付け合わ
                    </button>
                    -->
        		</div>
        		
##if(data.mathcMode) {##
        		<div class="panel-body" id="matchData">
        		    <div class="row">
            		    <form class="form-inline">
                            <div class="form-group">
                                <label class="sr-only">検索住所</label>
                                <input type="text" class="form-control" style="width:100px" id="matchAddressInput1" placeholder="住所1" 
                                        value="##=data.findServiceAddress1##">
                                <input type="text" class="form-control" style="width:150px" id="matchAddressInput2" placeholder="住所2" 
                                        value="##=data.findServiceAddress2##">
                                <input type="text" class="form-control" style="width:150px" id="matchAddressInput3" placeholder="住所3" 
                                        value="##=data.findServiceAddress3##">
                                <input type="text" class="form-control" style="width:150px" id="matchAddressInput4" placeholder="住所4" 
                                        value="##=data.findServiceAddress4##">
                                <input type="text" class="form-control" style="width:150px" id="matchAddressInput5" placeholder="住所5" 
                                        value="##=data.findServiceAddress5##">
                                <input type="text" class="form-control" style="width:150px" id="matchAddressName" placeholder="名前" 
                                        value="##=data.findServiceName##" readonly>
                            </div>
                            <button type="button" class="btn btn-primary" data-event="##:{
                                                                    click:function(e){
                                                                        findServiceModel.matchAddress();
                                                                    }}##">検索</button>
                                                                        
                            <button type="button" class="btn btn-default" data-event="##:{click:function(){refreshStorage();}}##">
                                <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span> 区域データ
                            </button>
                            <button type="button" data-event="##:findServiceModel.setToNew##" class="btn btn-default ##=(data.isNew==1) ? 'btn-success' : 'btn-default'##">新規</button>
            			    <button type="button" data-event="##:findServiceModel.setToDuplicate##" class="btn btn-default ##=(data.isNew==2) ? 'btn-success' : 'btn-default'##">既存</button>
                        </form>


        		    </div>
        		</div>
        		<div class="table-responsive">
            		<table class="table table-bordered" id="matchAddressTable">
                        <thead>
                            <tr class="active">
                                <th>class</th>
                                <th>住所</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
##}##
##if(data.editMode && data.editMode != 'no') {##
        		<div class="panel-body br-form">
                 	<div id="findServiceEditArea" class="form-edit panel-body" role="form">
            		    <input type="hidden" name="##=Bridge.idName##" value="##=data[Bridge.idName]##">

            			<div class="row">
                			<div class="form-group col-sm-4">
                				<label class="">登録日</label>
                				<input type="date" class="form-control" name="findServiceDate" value="##=data.findServiceDate##" placeholder="日付">
                			</div>
                		</div>
                		<div class="row">
                		    <div class="form-group col-sm-4">
                				<label class="">情報元</label>
            					<input type="text" name="findServiceFindFrom" list="findServiceFindFromList" value="##=data.findServiceFindFrom##" class="form-control"/>
                			</div>
                			<div class="form-group col-sm-4">
                				<label class="">地図:市区</label>
            				    <input type="text" name="findServiceMapKu" list="findServiceMapKuList" value="##=data.findServiceMapKu##" class="form-control">
                			</div>
                			<div class="form-group col-sm-4">
                				<label class="">ページ</label>
                				<div class="input-group">
            					    <input type="text" name="findServiceMapPage" list="findServiceMapPageList" value="##=data.findServiceMapPage##" class="form-control"/>
                                    <span class="input-group-btn">
                                        <button class="btn btn-default" type="button" data-event="##:findServiceModel.clearField##">
                                            <span class="glyphicon glyphicon-erase" aria-hidden="true"></span>
                                        </button>
                                    </span>
                                </div>
                			</div>
                		</div>
                		<div class="row">
                			<div class="form-group col-sm-8">
                				<label class="">住所</label>
                				<div class="row">
                				    <div class="col-sm-6">
                				        <div class="input-group">
                				            <input type="text" id="findServiceAddress1" name="findServiceAddress1" value="##=data.findServiceAddress1 || '神奈川県'##" class="form-control" placeholder="都道府県"/>
                				            <span class="input-group-btn">
                                                <button class="btn btn-default" type="button" data-event="##:findServiceModel.clearField##">
                                                    <span class="glyphicon glyphicon-erase" aria-hidden="true"></span>
                                                </button>
                                            </span>
                				        </div>
                				    </div>
                				</div>
                				<div class="row">
                				    <div class="col-sm-6">
                				        <div class="input-group">
                				            <input type="text" list="findServiceMapKuList" id="findServiceAddress2" name="findServiceAddress2" value="##=data.findServiceAddress2##" class="form-control" placeholder="市区"/>
                				            <span class="input-group-btn">
                                                <button class="btn btn-default" type="button" data-event="##:findServiceModel.clearField##">
                                                    <span class="glyphicon glyphicon-erase" aria-hidden="true"></span>
                                                </button>
                                            </span>
                				        </div>
                				    </div>
                				</div>
                				<div class="row">
                				    <div class="col-sm-6">
                				        <div class="input-group">
                    				        <input type="text" list="townNameList" id="findServiceAddress3" name="findServiceAddress3" value="##=data.findServiceAddress3##" class="form-control" placeholder="町村"/>
                    				        <span class="input-group-btn">
                                                <button class="btn btn-default" type="button" data-event="##:findServiceModel.clearField##">
                                                    <span class="glyphicon glyphicon-erase" aria-hidden="true"></span>
                                                </button>
                                            </span>
                                        </div>
                				    </div>
                				    <div class="col-sm-6">
                				        <div class="input-group">
                				            <input type="text" id="findServiceAddress4" name="findServiceAddress4" value="##=data.findServiceAddress4##" class="form-control" placeholder="番地"/>
                				            <span class="input-group-btn">
                                                <button class="btn btn-default" type="button" data-event="##:findServiceModel.clearField##">
                                                    <span class="glyphicon glyphicon-erase" aria-hidden="true"></span>
                                                </button>
                                            </span>
                				        </div>
                				    </div>
                				</div>
                				<div class="row">
                				    <div class="col-sm-12">
                				        <div class="input-group">
                				            <input type="text" id="findServiceAddress5" name="findServiceAddress5" value="##=data.findServiceAddress5##" class="form-control" placeholder="建物名"/>
                                            <span class="input-group-btn">
                                                <button class="btn btn-default" type="button" data-event="##:findServiceModel.clearField##">
                                                    <span class="glyphicon glyphicon-erase" aria-hidden="true"></span>
                                                </button>
                                            </span>
                                        </div>
                			        </div>
                			    </div>
                			</div>
                			<div class="form-group col-sm-4">
                				<label for="findServiceName" class="">名前</label>
                				<div class="input-group">
                				    <input type="text" id="findServiceName" name="findServiceName" value="##=data.findServiceName##" class="form-control"/>
                                    <span class="input-group-btn">
                                        <button class="btn btn-default" type="button" data-event="##:findServiceModel.clearField##">
                                            <span class="glyphicon glyphicon-erase" aria-hidden="true"></span>
                                        </button>
                                    </span>
                			    </div>
                			</div>
                		</div>
                        <div class="row">
                			<div class="form-group col-sm-12">
                				<label for="findServiceComment" class="">
                				    地図 <button data-event="##:findServiceModel.geocoding##" class="btn btn-primary btn-xs">地図で住所の場所を表示</button>
                				</label>
                				<div class="row">
                        		    <div class="form-group col-sm-4">
                        				<label class="">Lat.</label>
                    					<input type="text" id="findServiceLat" name="findServiceLat" value="##=data.findServiceLat##" class="form-control"/>
                        			</div>
                        		    <div class="form-group col-sm-4">
                        				<label class="">Lng.</label>
                    					<input type="text" id="findServiceLng" name="findServiceLng" value="##=data.findServiceLng##" class="form-control"/>
                        			</div>
                        		</div>
                				<span class="label label-warning">表示されている地図が正しいか確認していだだけると助かります</span>
                				<div id="map_canvas" style="width:100%; height:100%"></div>
                			</div>
                        </div>
                        <div class="row">
                			<div class="form-group col-sm-12">
                				<label for="findServiceComment" class="">コメント</label>
                				<textarea class="form-control" rows="3" id="findServiceComment" name="findServiceComment">##=data.findServiceComment##</textarea>
                			</div>
                        </div>
            		</div>
                    <nav class="navbar navbar-default navbar-fixed-bottom">
                        <div class="container">
                            <div class="navbar-header" style="padding:10px">
                                <div class="navbar-brand"style="height: 0px;"></div>
                                <div class="navbar-left">
                                    <button type="button" data-event="##:findServiceModel.save##" class="btn ##=data[Bridge.idName] ? 'btn-success' : 'btn-primary'## ">##=data[Bridge.idName] ? '修正' : '登録'##</button>
                                </div>
                                <div class="navbar-right">
                                    <button type="button" data-event="##:findServiceModel.restoreFromPrev##" class="btn btn-success ##=data.editMode != 'new' || !findServiceModel.savedData ? 'hidden': ''##">前回登録をコピー</button>
                                    <button type="button" data-event="##:findServiceModel.saveCancel##" class="btn">キャンセル</button>
                    		    </div>
                    		</div>
                        </div>
                    </nav>
        		</div>

##
}
if(data.list) {
##
        		<div class="panel-heading">
        		    <div class="form-inline">
        		    ##
        		    $.each(findServiceModel.searchForm, function(key, obj) {
        		        if (obj.lineBreak) {
        		    ##
        		    
            		</div>
            		<div class="form-inline">
            		    ##}##
                        <div class="form-group">
                            <label class="">##=obj.label##</label>
                            <input type="text" id="##=key##" list="##=obj.list##" value="##=data.search[key]##" class="form-control" style="##=obj.style##"/>
            			</div>
        		    ##});##
        		    <!--
                        <div class="form-group">
                            <label class="">情報元</label>
                            <input type="text" id="search_findServiceFindFrom" list="findServiceFindFromList" value="##=data.search.search_findServiceFindFrom##" class="form-control"/>
            			</div>
                        <div class="form-group">
                            <label class="">地図:市区</label>
                            <input type="text" list="findServiceMapKuList" id="search_findServiceMapKu" value="##=data.search.search_findServiceMapKu##" class="form-control"/>
            			</div>
                        <div class="form-group">
                            <label class="">ページ</label>
                            <input type="text" style="width:60px;" id="search_findServiceMapPage" value="##=data.search.search_findServiceMapPage##" class="form-control"/>
            			</div>
                        <div class="form-group">
                            <label class="">町村</label>
                            <input type="text" list="townNameList" id="search_findServiceMapTown" value="##=data.search.search_findServiceMapTown##" class="form-control"/>
            			</div>
                    -->
                		<div class="form-group">
                		    <select id="search_isNew" class="form-control" value="##=data.search.search_isNew##">
                		        <option value="">-新規有無-</option>
                                <option value="0" ##=data.search.search_isNew == '0' ? 'selected="selected"' : ""##>未設定</option>
                                <option value="1" ##=data.search.search_isNew == 1 ? 'selected="selected"' : ""##>新規</option>
                                <option value="2" ##=data.search.search_isNew == 2 ? 'selected="selected"' : ""##>既存</option>
                            </select>
                        </div>	
                		<div class="form-group">
                		    <select id="search_result" class="form-control" value="##=data.search.search_result##">
                		        <option value="">-結果-</option>
                		        ##$.each(findServiceModel.resultTypeModel, function(key, obj) {##
                		            <option value="##=key##" ##=data.search.search_result == key ? 'selected="selected"' : ""##>##=obj.label##</option>
                		        ##});##
                            </select>
                        </div>
            			<button class="btn btn-default" type="submit" data-event="##:findServiceModel.search##">検索</button>
        			</div>
        		</div>

        		<nav>
                    ##@Bridge.tmplTool.include('/tmpl/tmpl.pagenation.html', 'pagination')##
                </nav>

        		<div class="table-responsive">
            		<table class="table table-bordered">
                        <thead>
                            <tr class="active">
            					<th style="width:92px;">総計:##=data.listCount##</th>
            					<th>確認記録</th>
                                <th width="90px">登録日</th>
                                <th>情報元</th>
                                <th>住所</th>
                                <th>名前</th>
            					<th>コメント</th>
            					##if(findServiceModel.getAuth(1)) {##
            					<th>登録者</th>
            					##}##
                            </tr>
                        </thead>
                        <tbody>
            				##
            				totalData={};
            				$.each(data.list || {} , function(ind, obj) {
            				##
                            <tr class="##=(commonModel._id == obj.last_update_user) ? '' : ''##">
            					##
            					totalData.findServiceTotalCount = totalData.findServiceTotalCount ? totalData.findServiceTotalCount + 1 : 1;
            					##
                                <td>
                                    ##if (commonModel._id == obj.last_update_user || (commonModel._auth && commonModel._auth.find_service && commonModel._auth.find_service.save > 1)) {##
            						<button data-ind="##=ind##" data-id="##=obj[Bridge.idName]##" data-event="##:findServiceModel.lineEdit##" class="btn btn-default btn-xs">修正</button>
            						<button data-event="##:findServiceModel.lineDelete##" class="btn btn-default btn-xs">削除</button>
            					    ##}##
            					    <button data-event="##:findServiceModel.setToNew##" class="btn btn-xs ##=(obj.isNew==1) ? 'btn-success' : 'btn-default'##" ##if(!findServiceModel.getAuth(1)) {## disabled="disabled" ##}##>新規</button>
            					    <button data-event="##:findServiceModel.setToDuplicate##" class="btn btn-xs ##=(obj.isNew==2) ? 'btn-warning' : 'btn-default'##" ##if(!findServiceModel.getAuth(1)) {## disabled="disabled" ##}##>既存</button>
            					</td>
            					<td>
            					    <div class="btn-group">
                					    <button type="button" class="btn ##=findServiceModel.resultTypeModel[obj.result || 0].color## btn-xs dropdown-toggle" data-toggle="dropdown">
                                            ##=findServiceModel.resultTypeModel[obj.result || 0].label## <span class="caret"></span>
                                        </button>
                                        <ul class="dropdown-menu" role="menu">
                                            <li><a href="#" data-event="##:findServiceModel.setResult##" data-resultType="1" class="##=(obj.result==1) ? 'btn-success' : 'btn-default'##">韓国語</a></li>
                                            <li><a href="#" data-event="##:findServiceModel.setResult##" data-resultType="2" class="##=(obj.result==2) ? 'btn-info' : 'btn-default'##">日本語</a></li>
                                            <li><a href="#" data-event="##:findServiceModel.setResult##" data-resultType="3" class="##=(obj.result==3) ? 'btn-info' : 'btn-default'##">中国語</a></li>
                                            <li class="divider"></li>
                                            <li><a href="#" data-event="##:findServiceModel.setResult##" data-resultType="-1" class="##=(obj.result==-1) ? 'btn-warning' : 'btn-default'##">あいまい</a></li>
                                            <li><a href="#" data-event="##:findServiceModel.setResult##" data-resultType="-2" class="##=(obj.result==-2) ? 'btn-danger' : 'btn-default'##">住所不明</a></li>
                                            <li><a href="#" data-event="##:findServiceModel.setResult##" data-resultType="0" class="##=(!obj.result || obj.result==0) ? 'btn-info' : 'btn-default'##">未設定</a></li>
                                        </ul>
                                    </div>
            					</td>
                                <td>##=obj.findServiceDate##</td>
                                <td>##=obj.findServiceFindFrom## ##=obj.findServiceMapKu## ##=obj.findServiceMapPage##</td>
                                <td>
                                    ##if(findServiceModel.getAuth(1)) {##
                                    <button type="button" class="btn btn-default btn-xs" data-event="##:{click:function(e){
                                            Bridge.tmplTool.render('findServiceTable', Bridge.extend(e.data, {mathcMode: true, editMode: 'no'}));
                                            findServiceModel.matchAddress();
                                            //$('#matchAddressInput').val(data.findServiceAddress1 + data.findServiceAddress2 + data.findServiceAddress3 + data.findServiceAddress4);
                                        }}##">
                                        <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                                    </button>
                                    &nbsp;
                                    ##}##
                                    <a href="http://maps.google.co.jp/maps?q=##=(obj.findServiceLat && obj.findServiceLng) ? 'loc:' + obj.findServiceLat + ',' + obj.findServiceLng :  obj.findServiceAddress1 + obj.findServiceAddress2 + obj.findServiceAddress3 + ' ' + obj.findServiceAddress4##" target="gmap">
                                        ##=obj.findServiceAddress1####=obj.findServiceAddress2####=obj.findServiceAddress3####=obj.findServiceAddress4## ##=obj.findServiceAddress5##
                                    </a>
                                </td>
                                <td>##=obj.findServiceName##</td>
            					<td>##=obj.findServiceComment##</td>
            					##if(findServiceModel.getAuth(1)) {##
            					<td>##=obj.first_update_name##</td>
            					##}##
                            </tr>
                            ##});##
                        </tbody>
                        <tfoot>
                            <tr class="active">
            					<th>表示:##=totalData.findServiceTotalCount##</th>
                                <th></th>
                                <th></th>
                                <th id=""></th>
                                <th id=""></th>
                                <th id=""></th>
                                <th id=""></th>
            					##if(findServiceModel.getAuth(1)) {##
            					<th></th>
            					##}##
                            </tr>
                        </tfoot>
            		</table>
            	</div>
            	
        		<nav>
        		    ##@Bridge.tmplTool.include('/tmpl/tmpl.pagenation.html', 'pagination')##
                </nav>
##}##
		    </script>
		</div>
    </div>
    
    <div id="loadingModal" class="modal" data-keyboard="false" tabindex="-1" role="dialog" data-bind-tmpl-id="loadingBar" data-tmpl-src="./tmpl/tmpl.common.html">
    </div>
    
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDejNEedWnONLDewIynvzf6Wv-aI4sd3eU&amp;sensor=true"></script>
    <script src="js/jquery-2.1.0.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/underscore.js"></script>
    <script src="js/bridge.core.js"></script>
    <script src="js/bridge.date.js"></script>
    <script src="js/bridge.router.js"></script>
    <script src="js/app.js"></script>
    <script type="text/javascript">
        commonModel.loginCheckerAfter = function(data) {
            findServiceModel.savedData = Bridge.localStorageTool.get('findServiceModel_savedData');
            findServiceModel.listAreaReset();
        }
        commonModel.logoutAfter = function(data) {
            location.href = "/";
        }
        commonModel.loginCheckerFail = function(data) {
            location.href = "/";
        }

        var findServiceConn = new Bridge.Connector({dataName : "find_service",
            //url: navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|IEMobile)/) ? "https://bridge-c9-choish.c9.io/bridge" : "/bridge"});
            url: navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|IEMobile)/)
                         ?  ((document.URL.indexOf( 'http://' ) === -1 && document.URL.indexOf( 'https://' ) === -1) ? "https:" : "") + "//ykcform.herokuapp.com/bridge" : "/bridge"});

        var findServiceModel = {
            savedData: null,
            listData: null,
            listCount: 0,

			lineEdit: {click: function(e) {
					e.stopPropagation();
					findServiceConn.reqData('eventData', e.data._id).request(function(data, textStatus, jqXHR) {
						var data = data['eventData'];
						//data.list = findServiceModel.listData;
						data.editMode = 'lineEdit';
						Bridge.tmplTool.render('findServiceTable', data);
						if (data.findServiceLat && data.findServiceLng) {
						    findServiceModel.geocoding.mapCreate(new google.maps.LatLng(data.findServiceLat, data.findServiceLng));
						}
					});
					//alert(e.data.mark);
			}},
			lineDelete: {click: function(e) {
					e.stopPropagation();
					if (!confirm("'" + e.data.findServiceAddress3 + e.data.findServiceAddress4 + e.data.findServiceAddress5 + "' の記録を削除してもよろしいでしょか？")) {
					    return false;
					}
					
					findServiceConn.reqDelete('reqDelete', e.data._id).request(function(data, textStatus, jqXHR) {
						var data = data['reqDelete'];
						//$(e.target).parents('td').remove();
						findServiceModel.listAreaReset();
					});
					//alert(e.data.mark);
			}},
			geocoding: {
			    map: null,
			    geocoder: new google.maps.Geocoder(),
			    click: function(e) {
					e.stopPropagation();
                    
                    var address = '';
                    $('#findServiceAddress1, #findServiceAddress2, #findServiceAddress3, #findServiceAddress4, #findServiceAddress5').each(function(idx, obj) {
                        address += ' ' + obj.value;
                    })
                    findServiceModel.geocoding.latLngByAddress(address, function(latLng){
                        $('#findServiceLat').val(latLng.lat());
                        $('#findServiceLng').val(latLng.lng());
                        findServiceModel.geocoding.mapCreate(latLng);
                    });
			    },
			    mapCreate: function(latLng) {
                    var mapOptions = {
                        center: latLng,
                        zoom: 20,
                        mapTypeId: google.maps.MapTypeId.ROADMAP
                    };
                    var map_canvas = document.getElementById("map_canvas");
                    map_canvas.style.height = '400px';
                    var map = new google.maps.Map(map_canvas, mapOptions);
                    var marker = new google.maps.Marker({
                        //icon : 'https://chart.googleapis.com/chart?chst=d_map_pin_letter_withshadow&chld=' + idx + '|00a8e6|000000',
                        map: map,
                        position: latLng,
                        draggable: true
                    });
                    google.maps.event.addListener(marker, 'dragend', function() {
                        //map.setCenter(latLng);
                        var markerLatLng = marker.getPosition();
                        $('#findServiceLat').val(markerLatLng.lat());
                        $('#findServiceLng').val(markerLatLng.lng());
                    });
                    google.maps.event.addListener(map, 'click', function(event) {
                        var markerLatLng = event.latLng;
                        marker.setPosition(markerLatLng);
                        $('#findServiceLat').val(markerLatLng.lat());
                        $('#findServiceLng').val(markerLatLng.lng());
                        
                    });
                    //google.maps.event.addListener(marker, 'click', function() {
                    //    map.setCenter(latLng);
                    //});

			    }, 
			    latLngByAddress: function(address, func) {
                    findServiceModel.geocoding.geocoder.geocode({'address': address}, function(results, status) {
                        if (status == google.maps.GeocoderStatus.OK) {
                            //func(results[0].geometry.location);
                            func(results[0].geometry.location);
                        } else {
                            //console.log('Geocode失敗: ' + status  + '：' + address);
                            //mapTools.geocoding.latLngByAddress(address, func);
                            func(null);
                        }
                    });
			}},
			
			/*
			submit: {click: function(e) {
					var template = $(e.target).parents('.br-tmpl');
					var obj = Bridge.tmplTool.editor(template);
					findServiceConn.reqSave('reqSave', obj.data).request(function(data) {
						var data = data['reqSave'];
						findServiceModel.listAreaReset();
					});
			}},
			*/
			addNew: {click: function(e) {
			    Bridge.tmplTool.render('findServiceTable', {editMode: 'new'});
			}},
			clearField: {click: function(e) {
			    $(e.target).parents('.input-group').find('input').val('');
			}},
            save: {click: function(e) {
                var template = $(e.target).parents('.br-form');
                var obj = Bridge.tmplTool.editor(template, {
                    findServiceDate : {validateRule : {label: '登録日', isNullAble : false}},
                    findServiceFindFrom : {validateRule : {label: '情報元', isNullAble : false}},
                    findServiceAddress1 : {validateRule : {label: '住所', isNullAble : false}},
                    findServiceAddress2 : {validateRule : {label: '住所', isNullAble : false}},
                    findServiceAddress3 : {validateRule : {label: '住所', isNullAble : false}},
                    renderMessage : function(strArray) {
                        $(this.target).after('<span>' + strArray.join('<br/>') + '</span>')
                        .parent().addClass('has-error');
                    },
                    clearError : function(strArray) {
                        var $target = $(this.target);
                        $target.next('span').remove();
                        $target.parent().removeClass('has-error');
                    }
                });
                if (obj.validate()) {
                    //delete obj.data._id;
                    findServiceConn.reqSave('reqSave', obj.data).request(function(data) {
                        //delete data[reqSave][Bridge.idName];
                        findServiceModel.savedData = data['reqSave'];
                        Bridge.localStorageTool.push('findServiceModel_savedData', findServiceModel.savedData);
                        findServiceModel.listAreaReset();
                        commonModel.messageAreaReset(data);
                    });
                }
            }},
            saveComment: {click: function(e) {
                var template = $(e.target).parents('.br-form');
                var obj = Bridge.tmplTool.editor(template, {});
                if (obj.validate()) {
                    //delete obj.data._id;
                    findServiceConn.reqSave('reqSave', obj.data).request(function(data) {
                        e.data.findServiceComment = data.reqSave.findServiceComment;
                        findServiceModel.listAreaReset(false);
                        commonModel.messageAreaReset(data);
                        Bridge.tmplTool.render('searchedMapModal', e.data);
                        $('#searchedMapModal').modal('show');
                    });
                }
            }},
            saveCancel: {click: function(e) {
                findServiceModel.listAreaReset(false);
            }},
            restoreFromPrev: {click: function(e) {
                var findServiceModel_savedData = Bridge.localStorageTool.get('findServiceModel_savedData');
                
                delete findServiceModel_savedData[Bridge.idName];
                //delete findServiceModel_savedData.findServiceAddress4;
                delete findServiceModel_savedData.findServiceName;
                delete findServiceModel_savedData.findServiceComment;
                delete findServiceModel_savedData.findServiceLng;
                delete findServiceModel_savedData.findServiceLat;
                
                Bridge.tmplTool.render('findServiceTable', Bridge.extend({editMode: 'new'}, findServiceModel_savedData));
            }},
            /*
            update: {click: function(e) {
                
                var template = $(e.target).parent('.br-tmpl');
                var obj = Bridge.tmplTool.editor(template);
                findServiceConn.reqUpdate('reqInsert', obj.data._id, obj.data).request(function(data) {
                    findServiceModel.listAreaReset(data);
                });
            }},
            */
            setResult: {click: function(e) {
                var resultType = parseInt(e.target.dataset.resulttype);
                findServiceConn.reqUpdate('reqUpdate', e.data._id, {
                        result: resultType, 
                        result_update_name : commonModel.user.name,
                        result_update_date : Bridge.dateStr.getNowDate(),
                        result_update_user : commonModel.user._id
                    }).request(function(data) {
                    commonModel.messageAreaReset(data);
                    e.data.result = data.reqUpdate.result;
                    findServiceModel.listAreaReset(false);
                    if (e.target.dataset.frommap) {
                        Bridge.tmplTool.render('searchedMapModal', e.data);
                        $('#searchedMapModal').modal('show');
                    }
                });
            }},
            setToNew: {click: function(e) {
                findServiceConn.reqUpdate('reqUpdate', e.data._id, {isNew: e.data.isNew == 1 ? 0 : 1}).request(function(data) {
                    commonModel.messageAreaReset(data);
                    findServiceModel.listAreaReset();
                });
            }},
            setToDuplicate: {click: function(e) {
                findServiceConn.reqUpdate('reqUpdate', e.data._id, {isNew: e.data.isNew == 2 ? 0 : 2}).request(function(data) {
                    commonModel.messageAreaReset(data);
                    findServiceModel.listAreaReset();
                });
            }},
            
            getAuth: function(level) {
                return commonModel._auth && commonModel._auth.find_service && commonModel._auth.find_service.save > level;
            },
            
            matchAddress: function() {
                /*
                address2: "501"
                banchi: "22"
                chome: "1"
                cityward: "川崎市川崎区"class: "返却済"congregation: "川崎市中央"description: "日本語"fileno: "03"gou: ""id: "KWS5352070940"lastvisit: ""lat: "35.53521"lng: "139.70940"name: ""notice: ""phonetic_town: "ｱｻﾋﾁｮｳ"
                prefecture: "神奈川県"serial: "0"tel: ""
                town: "旭町"
                zipcode: "2100808"
                */
                var address1 = $('#matchAddressInput1').val();
                var address2 = $('#matchAddressInput2').val();
                var address3 = $('#matchAddressInput3').val();
                var address4 = $('#matchAddressInput4').val();
                var $matchAddressTableBody = $('#matchAddressTable tbody').empty();

                var exports = [];
                var data = null;
                var addr = null;
                var hasData = false;
                for (var key in exportdata) {
                    data = exportdata[key];
                    if (//data.prefecture == address1 && 
                            (data.cityward.indexOf(address2) > -1 || address2.indexOf(data.cityward) > -1) 
                            && (address3.indexOf(data.town) > -1 || data.town.indexOf(address3) > -1)) {
                        exports.push(data);
        				addr = data.cityward + ' ' + data.town + ' '+ data.chome;
        				addr += (data.banchi) ? ('-' + data.banchi):'';
        				addr += (data.gou) ? ('-' + data.gou):'';
        				addr += ' ' + data.address2 + ' ' + data.name;

                        hasData = true;
                        $('<tr><td>' + data.class + '</td><td>' + addr + '</td></tr>').appendTo($matchAddressTableBody);
                    }
                }
                if (!hasData) {
                    $('<tr><td></td><td>データがありません。</td></tr>').appendTo($matchAddressTableBody);
                }
            },
            
			listArea: {click: function(e) {
				findServiceModel.listAreaReset(false);
            }},
            
            pageSizeChange: {change: function(e) {
			    findServiceModel.page.pageSize = parseInt(e.target.value);
			    findServiceModel.page.pageNum = 1;
                findServiceModel.listAreaReset();
            }},
            pageSelect: {click: function(e) {
                findServiceModel.page.pageNum = parseInt(e.target.dataset.page);
                findServiceModel.listAreaReset();
            }},
            
            showSearchedMap: {click: function(e) {
                var listData = findServiceModel.listData;
                
                var $searchedMapArea = $('#searchedMapArea');
                
                $searchedMapArea.toggleClass('hidden');
                $('#findService').toggleClass('hidden');
                var isHidden = $searchedMapArea.hasClass('hidden');
                if (isHidden) {
                    $('#mapToggleButton').removeClass('btn-success');
                    return;
                }
                $('#mapToggleButton').addClass('btn-success');
                
                if (!findServiceModel.searchedMap) {
                    var mapOptions = {
                        center: {lat: parseFloat(listData[0].findServiceLat), lng: parseFloat(listData[0].findServiceLng)},
                        zoom: 14,
                        mapTypeId: google.maps.MapTypeId.ROADMAP
                    };
                    var map_canvas = document.getElementById("searchedMap");
                    //map_canvas.style.height = '400px';
                    findServiceModel.searchedMap = new google.maps.Map(map_canvas, mapOptions);
                }
                var map = findServiceModel.searchedMap;
                
                if (!findServiceModel.searchedMarkers) {
                    findServiceModel.searchedMarkers = [];
                }
                
                var searchedMarkers = findServiceModel.searchedMarkers;
                
                for(var ind in searchedMarkers) {
                    searchedMarkers[ind].setMap(null);
                }
                
                var marker, data = null;
                $.each(listData, function(ind, data) {
                //for (var ind in listData) {
                    //data = listData[ind];
                    marker = new google.maps.Marker({
                        //icon : 'https://chart.googleapis.com/chart?chst=d_map_pin_letter_withshadow&chld=' + idx + '|00a8e6|000000',
                        map: map,
                        position: {lat: parseFloat(data.findServiceLat), lng: parseFloat(data.findServiceLng)},
                        draggable: false
                    });
                    google.maps.event.addListener.call(this, marker, 'click', function(e) {
                        Bridge.tmplTool.render('searchedMapModal', data);
                        $('#searchedMapModal').modal('show');
                    });
                    searchedMarkers.push(marker);
                });
            }},
            
			search: {click: function(e) {
			    findServiceModel.page.pageNum = 1;

			    var search_findService = {};
			    var value = null;
			    for (var key in findServiceModel.searchForm) {
			        value = $('#' + key).val();
			        if (value) {
			            search_findService[key] = value;
			        }
			    }
			    value = $('#search_isNew').val();
			    if (value) {
			        search_findService['search_isNew'] = value;
			    }
			    value = $('#search_result').val();
			    if (value) {
			        search_findService['search_result'] = value;
			    }
			    
				Bridge.sessionStorageTool.push('search_findService', search_findService);
				findServiceModel.listAreaReset();
            }},
            listAreaReset: function(isReflash) {
                
				//var serviceDateMonth = $('#dat').val();
				var search_findService = Bridge.sessionStorageTool.get('search_findService') || {};
				$.each(search_findService, function(key, value) {
				    $('#' + key).val(value);
				});
				
			    if (isReflash == undefined) isReflash = true;
                if (!isReflash) {
                    var data = {};
                    data.search = search_findService;
                    data.page = findServiceModel.page;
                    data.list = findServiceModel.listData;
                    data.listCount = findServiceModel.listCount;
                    Bridge.tmplTool.render('findServiceTable', data);
                    return;
                }
				
				
				var searchParm = {$query: {}, $orderby: {findServiceDate : -1}};
				if (Object.keys(search_findService).length != 0) {
				    searchParm.$query.$and = [];
				}
				
				var searchFrom = findServiceModel.searchForm;
				var searchFormObj = null;
				var searchValue = null;
				for(var key in searchFrom) {
				    searchFormObj = searchFrom[key];
    				if (search_findService[key]) {
    				    searchValue = {};
    				    searchValue[searchFormObj.searchField] = {};
    				    searchValue[searchFormObj.searchField][searchFormObj.searchComparison] = search_findService[key];
                        searchParm.$query.$and.push(searchValue);
                        //searchParm.$query.$and.push({}[searchFormObj.searchField] = {}[searchFormObj.searchComparison] = search_findService[key]);
    				    //searchParm.$query.$and.push(JSON.parse('{"' + searchFormObj.searchField + '" : {"' + searchFormObj.searchComparison + '" : "' + search_findService[key] + '"}}'));
    				}
				}
				/*
				if (search_findService.search_findServiceFindFrom) {
                    searchParm.$query.$and.push({'findServiceFindFrom' : {$regex : search_findService.search_findServiceFindFrom}});
				}
				if (search_findService.search_findServiceMapPage) {
                    searchParm.$query.$and.push({'findServiceMapPage': {$eq : search_findService.search_findServiceMapPage}});
				}
				if (search_findService.search_findServiceMapKu) {
                    searchParm.$query.$and.push({'findServiceMapKu': {$regex : search_findService.search_findServiceMapKu}});
				}
				if (search_findService.search_findServiceMapTown) {
                    searchParm.$query.$and.push({'findServiceAddress3': {$regex : search_findService.search_findServiceMapTown}});
				}
				*/
				if (search_findService.search_isNew) {
				    if (search_findService.search_isNew == 0) {
				        searchParm.$query.$and.push({'$or': [{isNew : {$exists : false}}, {isNew : {$eq : 0}}, {isNew : {$eq : '0'}}]});
				    } else {
				        searchParm.$query.$and.push({'isNew': {$eq : parseInt(search_findService.search_isNew)}});
				    }
				}
				if (search_findService.search_result) {
				    if (search_findService.search_result == 0) {
				        searchParm.$query.$and.push({'$or': [{result : {$exists : false}}, {result : {$eq : 0}}]});
				    } else {
				        searchParm.$query.$and.push({'result': {$eq : parseInt(search_findService.search_result)}});
				    }
				}
				var pageSize = findServiceModel.page.pageSize;
				var pageNum = findServiceModel.page.pageNum;

                findServiceConn.reset()
                .reqCount('count', searchParm.$query)
                .reqList('reqList', searchParm, {skip: (pageSize * ( pageNum - 1 )), limit: pageSize})
                //.reqList('reqList', searchParm)
                .request(function(data, textStatus, jqXHR) {
                    findServiceModel.listCount = data['count'];
                    findServiceModel.listData = data['reqList'];
                    data.list = data['reqList'];
                    data.listCount = data['count'];
                    commonModel.messageAreaReset(data);
                    
                    data.search = search_findService;
                    data.page = findServiceModel.page;
                    
                    Bridge.tmplTool.render('findServiceTable', data);
                });
            },
        };

        findServiceModel.page = {
                pageSize: 20,
                pageNum: 1,
                pageWidth: 4,
                pageSelectFunc: findServiceModel.pageSelect,
                pageSizeChangeFunc: findServiceModel.pageSizeChange
        };

	    findServiceModel.searchForm = {
	        search_findServiceFindFrom: {
	            searchField: "findServiceFindFrom",
	            searchComparison : "$regex",
	            label: "情報元",
	            list: "findServiceFindFromList"
	        },
	        search_findServiceMapKu: {
	            searchField: "findServiceMapKu",
	            searchComparison : "$regex",
	            label: "地図:市区",
	            list: "findServiceMapKuList"
	        },
	        search_findServiceMapPage: {
	            searchField: "findServiceMapPage",
	            searchComparison : "$eq",
	            label: "ページ",
	            style: "width:60px;"
	        },
	        search_findServiceCityward: {
	            searchField: "findServiceAddress2",
	            searchComparison : "$regex",
	            label: "住所:市区",
	            list: "findServiceMapKuList",
	            lineBreak: 1
	        },
	        search_findServiceTown: {
	            searchField: "findServiceAddress3",
	            searchComparison : "$regex",
	            label: "町村",
	            list: "townNameList"
	        }
	    }
        findServiceModel.resultTypeModel = {
            '1': {label: '韓国語', color:'btn-success'},
            '2': {label: '日本語', color:'btn-info'}, 
            '3': {label: '中国語', color:'btn-info'}, 
            '-1': {label: 'あいまい', color:'btn-warning'}, 
            '-2': {label: '住所不明', color:'btn-danger'}, 
            '0': {label: '未設定', color:'btn-default'}
        };

        var exportdate = null;
        var exportdata = Bridge.localStorageTool.get('exportdata');
        function refreshStorage() {
            
            var paregoriaParm = {
                accept: 'application/json',
                auth: 'korean:1914',
                hostname: 'paregoria.ddns.net',
                port: 80,
                path: '/trtr/exportdate.json'
            }
            paregoriaParm.path = '/trtr/exportdate.json';
            findServiceConn.reqExecMethod('export', 'getDataByUrl', {parm: paregoriaParm}).request(function(data, textStatus, jqXHR) {
                if ((localStorage['exportdate'] || '0') < data['export'].lastvisit ){
                	paregoriaParm.path = '/trtr/export.json';
                	findServiceConn.reqExecMethod('export', 'getDataByUrl', {parm: paregoriaParm}).request(function(data, textStatus, jqXHR) {
                 	 	localStorage['exportdata'] = JSON.stringify(data['export']);
                 	 	exportdata = data['export'];
                	});
        			localStorage['exportdate'] = data['export'].lastvisit;
        			exportdate = data.lastvisit;
        		} else {
        		    exportdate = localStorage['exportdate'];
        		    exportdata = JSON.parse(localStorage['exportdata']);
        		}
    		});
        }
        


        Bridge.tmplTool.bindTmpl($('[data-bind-tmpl-id]'));

        Bridge.tmplTool.addTmpl($('[data-tmpl-id]'));
        Bridge.tmplTool.render('menu', {});
        
        
        var kanagwa_town = Bridge.localStorageTool.get('kanagwa_town');
        if (!kanagwa_town) {
            var kanagwaConn = new Bridge.Connector({dataName : "kanaga14",
                //url: navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|IEMobile)/) ? "https://bridge-c9-choish.c9.io/bridge" : "/bridge"});
                url: navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|IEMobile)/)
                         ?  ((document.URL.indexOf( 'http://' ) === -1 && document.URL.indexOf( 'https://' ) === -1) ? "https:" : "") + "//ykcform.herokuapp.com/bridge" : "/bridge"});
            
            kanagwaConn.reqDistinct('town', 'town_name', {$or: [{city_name: {$regex : '川崎市'}}, {city_name: {$regex : '横浜市'}}]}).request(function(data, textStatus, jqXHR) {
                if (data.error) {
                    return;
                }
                Bridge.localStorageTool.push('kanagwa_town', data);
                Bridge.tmplTool.render('townNameList', data);
            });
        } else {
            Bridge.tmplTool.render('townNameList', kanagwa_town);
        }
        



var Workspace = Bridge.Router.extend({

  routes: {
    "help":                 "help",    // #help
    "search/:query":        "search",  // #search/kiwis
    "search/:query/p:page": "search"   // #search/kiwis/p7
  },

  help: function() {
    console.log('help');
  },

  search: function(query, page) {
    console.log('search');
  }

});




var router = new Workspace().start();
        
        //if (Bridge.localStorageTool.get('keepLogin')) {
            commonModel.loginChecker();
        //} else {
        //    location.href = "/";
        //}
    </script>
</body>
</html>